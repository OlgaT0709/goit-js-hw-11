{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,iEAQA,MAEMC,EAAO,CACTC,WAAYC,SAASC,cAAc,gBACnCC,MAAOF,SAASC,cAAc,uBAC9BE,iBAAkBH,SAASC,cAAc,aAIvCG,EAAc,IAAI,EAAAC,EAAAC,SAAO,CAAEC,SAAU,aAAcC,QAAQ,EAAMC,KAAM,cACvEC,EAAY,IAAI,EAAAL,EAAAC,SAAO,CAAEC,SAAU,uBAAwBC,QAAQ,EAAOC,KAAM,WAChFE,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,cA6CnC,SAASC,EAAkBC,GACvB,GAA0B,IAAtBA,EAAMC,KAAKC,OAAf,CAQA,GAHAnB,EAAKK,iBAAiBe,mBAAmB,aAAa,EAAAC,EAAAb,SAAOS,EAAMC,OACnEL,EAAQS,UAEJC,EAAAf,QAAgBgB,WAAa,EAAG,CAE+C,MAAvEC,OAAQC,GAAe1B,EAAKK,iBAAiBsB,kBAAkBC,wBACvEC,OAAOC,SAAS,CACZC,IAAkB,EAAbL,EACLM,SAAU,U,CAInB,GAAIT,EAAAf,QAAgByB,aAAehB,EAAMiB,UAGrC,OAFApC,EAAAU,QAAS2B,KAAK,oEAAoElB,EAAMiB,oBACxF5B,EAAY8B,OAIf9B,EAAY+B,OAEZvC,EAAAU,QAAS8B,QAAQ,WAAWf,EAAAf,QAAgByB,mCAAmChB,EAAMiB,c,MAxBjFpC,EAAAU,QAAS+B,MAAM,2E,CA4BvB,SAASC,EAAWD,GACZzC,EAAAU,QAAS+B,MAAM,0CACfE,QAAQC,IAAIH,E,CA3EoBvC,EAAnCC,WAAW0C,iBAAiB,UAKjCC,eAA8BC,GAKF,GAJxBA,EAAMC,iBACsB9C,EAAvBK,iBAAiB0C,UAAY,GACRzC,EAAd8B,OACZb,EAAAf,QAAgBwC,MAAQH,EAAMI,cAAcC,SAASC,YAAYC,MAAMC,OACzC,KAA1B9B,EAAAf,QAAgBwC,MAEhB,YADAlD,EAAAU,QAAS8C,QAAQ,iCAGrB/B,EAAAf,QAAgB+C,YAChBhC,EAAAf,QAAgBgD,mBAEhB,IAEIxC,QADoBO,EAAAf,QAAgBiD,a,CAEtC,MAAOlB,GACLC,EAAWD,E,CACd,QACGvC,EAAKC,WAAWyD,QAChB9C,EAAU+C,U,KAvBlBrD,EAAYsD,OAAOjB,iBAAiB,SA4BpCC,iBAEItC,EAAYuD,YAAY,cACxB,IAEI7C,QADoBO,EAAAf,QAAgBiD,a,CAEtC,MAAOlB,GACLC,EAAWD,E,CACd,QACGjC,EAAYuD,YAAY,Y,KApChC7D,EAAKI,MAAMuC,iBAAiB,QAAS7B,EAAAgD,EAAA,EAAU,IAAMlD,EAAUmD,UAfxC","sources":["src/js/gallery3.js"],"sourcesContent":["import notifier from './service/notifler'\nimport markup from './markup'; \nimport photoApiService from './PhotoApiService';\nimport NewBtn from './service/newbutton';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\"\nimport debounce from 'lodash.debounce';\n\nconst DEBOUNCE_DELAY = 300;\n\nconst refs = {\n    searchForm: document.querySelector('#search-form'),\n    input: document.querySelector('.search-form__input'),\n    galleryContainer: document.querySelector('.gallery'),\n          \n};\n\nconst loadMoreBtn = new NewBtn({ selector: '.load-more', hidden: true, text: 'Load-more' });\nconst searchBtn = new NewBtn({ selector: '.search-form__button', hidden: false, text: 'Search' });\nconst gallery = new SimpleLightbox('.gallery a'); // створюємо модалку і передаємо велику картинку\n\nrefs.searchForm.addEventListener('submit', onSearchSubmit);\nloadMoreBtn.button.addEventListener('click', onLoadMoreClick);\nrefs.input.addEventListener('input', debounce((() => searchBtn.enable()), DEBOUNCE_DELAY) );\n\n\nasync function onSearchSubmit(event) {\n    event.preventDefault(); // прибираємо дефолтову поведінку\n    refs.galleryContainer.innerHTML = ''; // стартово прибираємо розмітку\n    loadMoreBtn.hide();\n    photoApiService.query = event.currentTarget.elements.searchQuery.value.trim(); //trim прибираються зайві пробіли\n    if (photoApiService.query === '') { // перевіряємо чи взагалі щось введено \n        notifier.warning(\"No request. Please try again.\")\n        return;\n    }\n    photoApiService.resetPage();\n    photoApiService.resetViewedPhoto();\n\n    try {\n        const photo = await photoApiService.fetchPhoto();\n        appendPhotoMarkUp(photo);\n    } catch (error) {\n        catchError(error);\n    } finally {\n        refs.searchForm.reset();\n        searchBtn.disabled();\n    };\n    \n}\n    \nasync function onLoadMoreClick() {\n    \n    loadMoreBtn.textContent('Loading...');\n    try {\n        const photo = await photoApiService.fetchPhoto();\n        appendPhotoMarkUp(photo);\n    } catch (error) {\n        catchError(error);\n    } finally {\n        loadMoreBtn.textContent('Load more'); \n    };\n           \n};\n\nfunction appendPhotoMarkUp(photo) {\n    if (photo.hits.length === 0) { // перевіряємо чи щось знайдено \n        notifier.error(\"Sorry, there are no images matching your search query. Please try again.\")\n        return;\n    }\n    \n    refs.galleryContainer.insertAdjacentHTML('beforeend', markup(photo.hits));\n    gallery.refresh(); // Refresh Imag\n    \n    if (photoApiService.pageNumber > 2) {\n        //   плавне прокручування сторінки після запиту і відтворення кожної наступної групи зображень\n        const { height: cardHeight } = refs.galleryContainer.firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\",\n        });\n    }\n      \n   if (photoApiService.viewedPhoto >= photo.totalHits) {\n       notifier.info(`We're sorry, but you've reached the end of search results. Total ${photo.totalHits}. `);\n       loadMoreBtn.hide();\n       return;\n    }  \n\n    loadMoreBtn.show(); // Показуємо кнопку loadMore\n  \n    notifier.success(`Hooray! ${photoApiService.viewedPhoto} images for you from ${photo.totalHits} !`);\n     \n}\n\nfunction catchError(error) {\n        notifier.error('Something went wrong. Please try later');\n        console.log(error);\n    \n    }\n\n"],"names":["$cNM6c","parcelRequire","$be859a28b3138557$var$refs","searchForm","document","querySelector","input","galleryContainer","$be859a28b3138557$var$loadMoreBtn","$dwE1g","default","selector","hidden","text","$be859a28b3138557$var$searchBtn","$be859a28b3138557$var$gallery","$parcel$interopDefault","$fZKcF","$be859a28b3138557$var$appendPhotoMarkUp","photo","hits","length","insertAdjacentHTML","$3huUq","refresh","$fxhcZ","pageNumber","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","viewedPhoto","totalHits","info","hide","show","success","error","$be859a28b3138557$var$catchError","console","log","addEventListener","async","event","preventDefault","innerHTML","query","currentTarget","elements","searchQuery","value","trim","warning","resetPage","resetViewedPhoto","fetchPhoto","reset","disabled","button","textContent","$50Kfe","enable"],"version":3,"file":"gallery3.09f51408.js.map"}