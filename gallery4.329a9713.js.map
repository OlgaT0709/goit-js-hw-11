{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAQA,MAEMC,EAAO,CACTC,WAAYC,SAASC,cAAc,gBACnCC,MAAOF,SAASC,cAAc,uBAC9BE,iBAAkBH,SAASC,cAAc,YACzCG,YAAaJ,SAASC,cAAc,eAIlCI,EAAY,IAAI,EAAAC,EAAAC,SAAO,CAAEC,SAAU,uBAAwBC,QAAQ,EAAOC,KAAM,WAChFC,EAAW,IAAIC,sBAAsBC,IACvC,IAAK,MAAMC,KAASD,EACZC,EAAMC,gBAAkBC,EAAAT,QAAgBU,WAAa,GACrDD,EAAAT,QAAgBW,aAAaC,KAAKC,EAAkB,GAG7D,CAAEC,WAAY,UA2BjB,SAASD,EAAkBE,GAEvB,GAA0B,IAAtBA,EAAMC,KAAKC,OAEX,YADA5B,EAAAW,QAASkB,QAAQ,4EAIrB3B,EAAKK,iBAAiBuB,mBAAmB,aAAa,EAAAC,EAAApB,SAAOe,EAAMC,OAKpE,GAHiB,IAAIK,EAAAC,GAAJ,CAAmB,cAC3BC,UAELd,EAAAT,QAAgBwB,cAAgBT,EAAMU,UAGtC,OAFApC,EAAAW,QAASkB,QAAQ,oEAAoEH,EAAMU,oBAC3FrB,EAASsB,aAGZrC,EAAAW,QAAS2B,QAAQ,WAAWlB,EAAAT,QAAgBwB,mCAAmCT,EAAMU,c,CA1CzFlC,EAAKC,WAAWoC,iBAAiB,UAIjC,SAAwBC,GAII,GAHxBA,EAAMC,iBACsBvC,EAAvBK,iBAAiBmC,UAAY,GAClCtB,EAAAT,QAAgBgC,MAAQH,EAAMI,cAAcC,SAASC,YAAYC,MAAMC,OACzC,KAA1B5B,EAAAT,QAAgBgC,MAEhB,YADA3C,EAAAW,QAASsC,KAAK,iCAGlB7B,EAAAT,QAAgBuC,YAChB9B,EAAAT,QAAgBwC,mBAEhB/B,EAAAT,QAAgBW,aACXC,KAAKC,GACL4B,QAAQlD,EAAKC,WAAWkD,QACjB5C,EAAU6C,YAGtBvC,EAASwC,QAAQrD,EAAKM,Y,IApB1BN,EAAKI,MAAMiC,iBAAiB,QAASP,EAAAwB,EAAA,EAAU,IAAM/C,EAAUgD,UApBxC,K","sources":["src/js/gallery4.js"],"sourcesContent":["import notifier from './service/notifler'\nimport markup from './markup'; \nimport photoApiService from './PhotoApiService';\nimport NewBtn from './service/newbutton';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\"\nimport debounce from 'lodash.debounce';\n\nconst DEBOUNCE_DELAY = 300;\n\nconst refs = {\n    searchForm: document.querySelector('#search-form'),\n    input: document.querySelector('.search-form__input'),\n    galleryContainer: document.querySelector('.gallery'),\n    loadMoreBtn: document.querySelector('.load-more'),\n          \n};\n\nconst searchBtn = new NewBtn({ selector: '.search-form__button', hidden: false, text: 'Search' });\nconst observer = new IntersectionObserver((entries) => {\n    for (const entry of entries) {\n        if (entry.isIntersecting && photoApiService.pageNumber > 1) {\n            photoApiService.fetchPhoto().then(appendPhotoMarkUp);\n        }\n    }\n}, { rootMargin: '400px' });\n\nrefs.searchForm.addEventListener('submit', onSearchSubmit);\nrefs.input.addEventListener('input', debounce((() => searchBtn.enable()), DEBOUNCE_DELAY) );\n\n\nfunction onSearchSubmit(event) {\n    event.preventDefault(); // прибираємо дефолтову поведінку\n    refs.galleryContainer.innerHTML = ''; // стартово прибираємо розмітку\n    photoApiService.query = event.currentTarget.elements.searchQuery.value.trim(); //trim прибираються зайві пробіли\n    if (photoApiService.query === '') { // перевіряємо чи взагалі щось введено \n        notifier.info(\"No request. Please try again.\")\n        return;\n    }\n    photoApiService.resetPage();\n    photoApiService.resetViewedPhoto();\n\n    photoApiService.fetchPhoto()\n        .then(appendPhotoMarkUp)\n        .finally(refs.searchForm.reset(),\n                searchBtn.disabled()\n    );\n    \n    observer.observe(refs.loadMoreBtn); // вішаємо обзервер для можливості скролу \n}\n    \n\nfunction appendPhotoMarkUp(photo) {\n       \n    if (photo.hits.length === 0) { // перевіряємо чи щось знайдено \n        notifier.warning(\"Sorry, there are no images matching your search query. Please try again.\")\n        return;\n    }\n    \n    refs.galleryContainer.insertAdjacentHTML('beforeend', markup(photo.hits));  \n\n    const gallery = new SimpleLightbox('.gallery a'); // створюємо модалку і передаємо велику картинку\n    gallery.refresh(); // Refresh Imag\n    \n   if (photoApiService.viewedPhoto === photo.totalHits) {\n       notifier.warning(`We're sorry, but you've reached the end of search results. Total ${photo.totalHits}. `);\n       observer.disconnect(); // знімаємо обзервер, так як показали все\n       return;\n    }\n    notifier.success(`Hooray! ${photoApiService.viewedPhoto} images for you from ${photo.totalHits} !`);\n}\n    \n\n    \n    \n"],"names":["$hzery","parcelRequire","$aebf0e91dcfc1f91$var$refs","searchForm","document","querySelector","input","galleryContainer","loadMoreBtn","$aebf0e91dcfc1f91$var$searchBtn","$co4Ad","default","selector","hidden","text","$aebf0e91dcfc1f91$var$observer","IntersectionObserver","entries","entry","isIntersecting","$8IJcu","pageNumber","fetchPhoto","then","$aebf0e91dcfc1f91$var$appendPhotoMarkUp","rootMargin","photo","hits","length","warning","insertAdjacentHTML","$1KhuP","$parcel$interopDefault","$5IjG7","refresh","viewedPhoto","totalHits","disconnect","success","addEventListener","event","preventDefault","innerHTML","query","currentTarget","elements","searchQuery","value","trim","info","resetPage","resetViewedPhoto","finally","reset","disabled","observe","$l1Gdk","enable"],"version":3,"file":"gallery4.329a9713.js.map"}